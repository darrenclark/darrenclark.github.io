{{ define "main" }}
<div class="flex items-center gap-3 mb-8">
    <span class="text-accent-light dark:text-accent-dark font-bold text-xl font-mono">##</span>
    <h2 class="text-2xl font-semibold">Articles</h2>
</div>

{{ $pages := where .Pages "Section" "articles" }}
{{ $pagesByYear := dict }}

{{/* Group pages by year */}}
{{ range $pages }}
    {{ $year := .Date.Format "2006" }}
    {{ $yearPages := index $pagesByYear $year }}
    {{ $yearPages = $yearPages | append . }}
    {{ $pagesByYear = merge $pagesByYear (dict $year $yearPages) }}
{{ end }}

{{/* Sort years in descending order */}}
{{ $years := slice }}
{{ range $year, $_ := $pagesByYear }}
    {{ $years = $years | append $year }}
{{ end }}
{{ $years = sort $years "value" "desc" }}

{{/* Display articles grouped by year */}}
{{ range $years }}
    {{ $year := . }}
    {{ $yearPages := index $pagesByYear $year }}
    
    <div class="mb-8">
        <h3 class="text-xl font-semibold text-accent-light dark:text-accent-dark mb-3 font-mono">{{ $year }}</h3>
        <div class="space-y-2">
            {{ range $yearPages }}
            <a href="{{ .RelPermalink }}" class="flex flex-col md:flex-row gap-1 md:gap-4 py-1 text-gray-700 dark:text-gray-200 hover:text-link-light dark:hover:text-link-dark transition-colors">
                <time datetime="{{ .Date.Format "2006-01-02" }}" class="text-gray-500 dark:text-gray-400 text-sm min-w-[80px] shrink-0">{{ .Date.Format "Jan 2" }}</time>
                <span>{{ .Title }}</span>
            </a>
            {{ end }}
        </div>
    </div>
{{ end }}
{{ end }}
