<html>
<head>
  
  
  
    
    
  

  <title>Commands, args, and ENTRYPOINTs in Kubernetes | Darren Clark</title>

  
  
  <link rel=stylesheet type="text/css" href="https://darrenclark.ca/style.d4a8a94fd6a13304063d6adcc7ef215f620a6138e30a4bfdcfc65162f0ac61563783ae9fb0f60cf53b89b354a233cc1176661d2630dbc438be14d62d6802a48b.css"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="canonical" content="https://darrenclark.ca/commands-args-and-entrypoints-in-kubernetes/">

  <link rel="alternate" type="application/rss+xml" title="Feed for darrenclark.ca" href="/feed.xml" />

  <meta property="og:title" content="Commands, args, and ENTRYPOINTs in Kubernetes">
  <meta property="og:site_name" content="Darren Clark">
  <meta property="og:url" content="https://darrenclark.ca/commands-args-and-entrypoints-in-kubernetes/">
  <meta property="og:image" content="https://darrenclark.ca/apple-touch-icon.png" />

  
  <meta property="og:type" content="article">
  <meta property="og:description" content="What command will my container actually going to run?  Let&rsquo;s explore how Kubernetes decides which command to run.">
  <meta name="description" content="What command will my container actually going to run?  Let&rsquo;s explore how Kubernetes decides which command to run.">
  


  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NL59FNTT94"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-NL59FNTT94');
  </script>
  

</head>
<body class="bg-bg-light dark:bg-bg-dark text-gray-700 dark:text-gray-200 transition-colors duration-300">
    <div class="max-w-3xl mx-auto px-6 md:px-8 py-8">
        
        <header class="mb-16 md:pb-6 border-b-2 border-border-light dark:border-border-dark">
            <div class="flex justify-between items-center mb-2 md:mb-0">
                <h1 class="text-2xl font-bold">
                    <a href="/" class="text-gray-700 dark:text-gray-200 hover:text-link-light dark:hover:text-link-dark transition-colors">Darren Clark</a>
                </h1>
                <div class="flex items-center gap-6">
                    <nav class="hidden md:flex gap-6">
                        <a href="/about" class="text-gray-500 dark:text-gray-400 hover:text-link-light dark:hover:text-link-dark transition-colors text-[0.95rem]">About</a>
                        <a href="/articles" class="text-gray-500 dark:text-gray-400 hover:text-link-light dark:hover:text-link-dark transition-colors text-[0.95rem]">Articles</a>
                    </nav>
                    <div class="flex items-center gap-4">
                        <button onclick="toggleTheme()" aria-label="Toggle theme" class="text-gray-500 dark:text-gray-400 hover:text-link-light dark:hover:text-link-dark transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[22px] h-[22px]">
                                <path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <nav class="flex md:hidden justify-center gap-8 mt-2">
                <a href="/about" class="text-gray-500 dark:text-gray-400 hover:text-link-light dark:hover:text-link-dark transition-colors text-[0.95rem] py-2 px-10 min-h-[44px] flex items-center">About</a>
                <a href="/articles" class="text-gray-500 dark:text-gray-400 hover:text-link-light dark:hover:text-link-dark transition-colors text-[0.95rem] py-2 px-10 min-h-[44px] flex items-center">Articles</a>
            </nav>
        </header>

        
        <main>
            
<article>
    <div class="mb-12">
        <h2 class="text-[2rem] font-bold mb-3 leading-tight">Commands, args, and ENTRYPOINTs in Kubernetes</h2>
        <div class="text-gray-500 dark:text-gray-400 text-[0.95rem]">
            Published on Feb 19, 2022
            
            in
            
                
                <a href="/tags/kubernetes" class="text-link-light dark:text-link-dark hover:opacity-70">#kubernetes</a>
            
            
        </div>
    </div>

    <div class="markdown prose prose-lg max-w-none">
        <p>Perhaps one of the most perplexing parts of starting a Docker container in
Kubernetes is the variety of options for specifying the command to be run.</p>
<p>A <code>Dockerfile</code> can include one or both of <code>CMD</code> and <code>ENTRYPOINT</code> instructions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-docker" data-lang="docker"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;echo&#34;</span><span class="p">,</span> <span class="s2">&#34;hello, world!&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-docker" data-lang="docker"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;echo&#34;</span><span class="p">]</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;hello, world!&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-docker" data-lang="docker"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;echo&#34;</span><span class="p">,</span> <span class="s2">&#34;hello, world!&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><p>Similarly, Kubernetes has <code>command</code> and <code>args</code> fields:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;echo&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;hello, world!&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span></code></pre></div><p>Frustratingly, the terminology doesn&rsquo;t quite line up between the two:</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>command</th>
          <th>arguments</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Docker</strong></td>
          <td><code>ENTRYPOINT</code></td>
          <td><code>CMD</code></td>
      </tr>
      <tr>
          <td><strong>Kubernetes</strong></td>
          <td><code>command</code></td>
          <td><code>args</code></td>
      </tr>
  </tbody>
</table>
<p><em>NOTE: In the cases where <code>command</code> or <code>args</code> isn&rsquo;t set, Kubernetes will use
the equivalent instruction from the <code>Dockerfile</code>.</em></p>
<p>Both &lsquo;command&rsquo; and &lsquo;arguments&rsquo; are lists.  As such, the &lsquo;command&rsquo; portion can
include both the executable and some arguments.</p>
<table>
  <thead>
      <tr>
          <th>command</th>
          <th>arguments</th>
          <th>command run</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>[&quot;echo&quot;]</code></td>
          <td><code>[&quot;hello&quot;, &quot;world&quot;]</code></td>
          <td><code>echo hello world</code></td>
      </tr>
      <tr>
          <td><code>[&quot;echo&quot;, &quot;hello&quot;]</code></td>
          <td><code>[&quot;world&quot;]</code></td>
          <td><code>echo hello world</code></td>
      </tr>
  </tbody>
</table>
<h1 id="putting-this-to-use">Putting this to use</h1>
<p>We can leverage these two fields to build Docker images that are easy to run
locally, yet are flexible when deployed.</p>
<p>In our <code>Dockerfile</code>, we&rsquo;ll use <code>ENTRYPOINT</code> to define the &ldquo;base command&rdquo; and
<code>CMD</code> to provide a set of default options.  When deploying this container,
we can override the default options by specifying <code>args</code> in our Kubernetes
manifests.</p>
<p>For example, here&rsquo;s a <code>Dockerfile</code> file using Python&rsquo;s
<a href="https://docs.python.org/3/library/http.server.html">bundled web server</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-docker" data-lang="docker"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">python:3-alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/site</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> index.html ./<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;python3&#34;</span><span class="p">,</span> <span class="s2">&#34;-m&#34;</span><span class="p">,</span> <span class="s2">&#34;http.server&#34;</span><span class="p">]</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;8000&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><p>We can build and run this locally:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">docker build -t my-python-web-server:v1 .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># uses port 8000 from the Dockerfile</span>
</span></span><span class="line"><span class="cl">docker run -it -p8000:8000 my-python-web-server:v1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># and, we can override CMD to use a different port</span>
</span></span><span class="line"><span class="cl">docker run -it -p8123:8123 my-python-web-server:v1 <span class="m">8123</span>
</span></span></code></pre></div><p>When we deploy this to Kubernetes, we can use <code>args</code> to easily set a port
to listen on:</p>
<p><em>NOTE: using a <a href="https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/">static Pod</a>
for brevity, usually a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a> or similar would be used in a production environment.</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># pod.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-python-web-server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-python-web-server:v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;8888&#34;</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p>We can apply this and use <code>kubectl</code>&rsquo;s port forwarding functionality to access
our web server:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">kubectl apply -f pod.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kubectl port-forward pods/my-python-web-server 8888:8888
</span></span></code></pre></div><h1 id="wrapping-up">Wrapping up</h1>
<p>By using this pattern, we&rsquo;ve:</p>
<ul>
<li>provided a set of default options to run our image locally, and</li>
<li>made it easy to override those defaults when running in Kubernetes</li>
</ul>
<p>It should also be noted, this pattern works good for the above use case.  There
are many other uses cases for these parameters.</p>

    </div>
</article>

        </main>

        
        <footer class="mt-20 pt-8 border-t border-border-light dark:border-border-dark text-center text-gray-500 dark:text-gray-400 text-sm">
            <p>Â© 2025 Darren Clark</p>
            <p class="mt-1">
                <a href="http://creativecommons.org/licenses/by-sa/2.5/ca/" class="text-link-light dark:text-link-dark hover:opacity-70">CC BY-SA 2.5 CA</a> (content) / 
                <a href="https://unlicense.org" class="text-link-light dark:text-link-dark hover:opacity-70">Unlicense</a> (code snippets)
            </p>
        </footer>
    </div>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                html.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        }

        
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          if (savedTheme === 'dark') {
            document.documentElement.classList.add('dark');
          }
        } else {
          const systemIsDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          if (systemIsDark) {
            document.documentElement.classList.add('dark');
          }
        }
    </script>
</body>
</html>
